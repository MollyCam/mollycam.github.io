---
title: 功能介绍
description: 功能介绍
---


# 功能介绍

## 3. 功能需求

### 3.1 用户管理
#### 3.1.1 本地用户登录

##### 功能概述
本地用户登录采用无密码的简单登录模式，旨在提供快速、便捷的用户认证机制，同时保持基本的用户隔离。

##### 功能详细说明

###### 1. 登录界面
- 设计风格：极简主义，清晰直观
- 界面元素：
  - 用户名输入框
  - 登录按钮
  - 最近登录用户下拉列表（当有历史登录记录时显示）

###### 2. 登录流程
- 新用户登录：
  - 输入新用户名（2-20个字符，支持中英文、数字、下划线）
  - 点击登录按钮或按回车键确认
  - 系统记录新用户信息并跳转至拍摄图片界面
- 已有用户登录：
  - 从下拉列表选择已有用户名或直接输入
  - 点击登录按钮或按回车键确认
  - 验证登录状态并跳转至拍摄图片界面

###### 3. 登录状态管理
- 登录信息存储：
  - 用户名存储在浏览器本地存储中
  - 最多保存10个最近登录的用户名
  - 超过限制时，自动删除最早的登录记录
- 登录状态维护：
  - 登录有效期：3天
  - 使用本地存储记录登录时间戳
  - 定期检查登录状态有效性

###### 4. 用户信息展示
- 登录后界面：
  - 顶部导航栏右侧显示用户名
  - 鼠标悬停显示操作菜单（包含"退出登录"选项）
- 用户信息关联：
  - 拍照记录关联当前登录用户
  - 视频记录关联当前登录用户
  - 用户信息写入数据库User字段

##### 异常处理
1. 输入验证
   - 用户名为空：提示"用户名不能为空"
   - 用户名格式错误：提示"用户名格式不正确，请使用2-20个字符"
   - 用户名包含特殊字符：提示"用户名只能包含中英文、数字和下划线"

2. 登录状态异常
   - 登录状态失效：自动跳转至登录页面
   - 本地存储异常：清除异常数据，重新登录
   - 多标签页登录冲突：保持最新登录状态

3. 网络异常
   - 数据库连接失败：提示"系统异常，请稍后重试"
   - 数据写入失败：本地保存失败记录，后续自动重试

##### 安全考虑
1. 数据安全
   - 本地存储加密：使用安全算法加密存储的用户信息
   - 定期清理：超过保存期限的数据自动清理

2. 操作安全
   - 防重复提交：登录按钮点击后禁用1秒
   - 登录频率限制：同一IP每分钟最多尝试30次登录

##### 性能优化
1. 本地存储优化
   - 定期清理过期数据
   - 限制存储数据大小

2. 登录检查优化
   - 使用缓存减少数据库查询
   - 异步验证登录状态

##### 业务流程
1. 首次访问流程
   - 检查登录状态 -> 未登录 -> 显示登录页面 -> 输入用户名 -> 验证格式 -> 保存用户信息 -> 跳转主页

2. 二次访问流程
   - 检查登录状态 -> 已登录且未过期 -> 直接跳转主页
   - 检查登录状态 -> 已登录但已过期 -> 显示登录页面（预填充上次用户名）

3. 退出流程
   - 点击退出 -> 清除登录状态 -> 跳转登录页面

##### 权限要求
1. 存储权限
   - 需要浏览器本地存储权限
   - 需要数据库写入权限

2. 功能权限
   - 登录用户可访问所有基础功能
   - 未登录用户只能访问登录页面

##### 技术实现要点
1. 前端实现
   - 使用LocalStorage存储用户信息
   - 使用SessionStorage存储临时登录状态
   - 使用Vue Router进行路由控制

2. 后端实现
   - 使用JWT管理登录状态
   - 使用Redis缓存用户信息
   - 使用SQLite持久化存储

### 3.2 视频录制
#### 3.2.1 包裹拍照
- 功能描述：
  - 支持多摄像头切换
  - 实时预览画面
  - 支持画面翻转
  - 支持画面缩放
  - 支持定时拍摄（回车延迟2秒）
  - 支持快捷键拍摄
  - 图片自动添加时间戳和文件名水印
  - 支持店铺选择和关联
  - 支持自定义文件名
  
- 拍照要求：
  - 支持高/中/低三种图片质量选择
  - 默认分辨率：1920x1080
  - 支持 16:9 比例显示
  
- 存储规则：
  - 按日期自动创建目录
  - 支持自定义存储路径
  - 自动创建 imageUploads 子目录
  
- 图片处理流程：
  - 实时预览
  - 添加水印
  - 质量压缩
  - 本地存储
  - 数据库记录

#### 3.2.2 开箱视频
- 功能描述：
  - 支持多摄像头切换
  - 实时预览画面
  - 可配置录制时长（10-300秒）
  - 支持视频暂停和继续
  - 支持提前结束录制
  
- 录制限制：
  - 最短录制时间：10秒
  - 最长录制时间：300秒
  - 默认录制时长：60秒
  
- 存储规则：
  - 按日期自动创建目录
  - 支持自定义存储路径
  - 自动创建 videoUploads 子目录
  
- 视频处理流程：
  - 实时预览
  - 格式转换
  - 本地存储
  - 数据库记录

### 3.3 历史记录管理
- 列表展示规则：
  - 支持图片和视频记录分类显示
  - 按时间倒序排列
  - 显示缩略图预览
  - 显示文件名、创建时间、关联店铺等信息
  
- 搜索筛选功能：
  - 支持按日期范围筛选
  - 支持按店铺筛选
  - 支持按用户筛选
  - 支持按文件类型筛选
  
- 数据导出功能：
  - 支持数据库备份
  - 支持数据库恢复
  - 支持查看数据库大小和位置

### 3.4 主题系统
- 主题切换：
  - 支持浅色/深色主题切换
  - 主题状态全局同步
  - 主题设置本地持久化
  - 支持系统主题跟随

- 主题定制：
  - 自定义主题色
  - 自定义边框圆角
  - 自定义过渡动画
  - 支持主题覆盖配置

### 3.5 软件设置
- 音频反馈：
  - 拍摄成功提示音（随机5种）
  - 操作失败提示音
  - 可自定义音效

- 界面交互：
  - 支持快捷键操作
  - 支持拖拽操作
  - 支持触摸屏操作
  - 响应式布局适配

### 3.6 本地化功能
- 界面语言选择
  - 默认中文，可以切换为英文
- 界面主题选择
  - 默认浅色主题，可以切换为深色主题
- 拍摄文件的本地目录
  - 默认目录：用户文档目录下的 MollyCamera 文件夹
  - 支持自定义修改
  - 自动创建子文件夹结构：images/和videos/
- 拍摄数据库选择
  - 默认使用 SQLite
  - 数据库文件位置：与应用配置文件同目录
  - 支持数据库备份和恢复
- 如有多个摄像头，摄像头选择
  - 自动识别系统可用摄像头，如果是移动设备打开（ipad），可以自动识别设备的前置和后置摄像头，并且可以切换；如果是电脑打开，默认使用前置摄像头；
  - 支持切换和保存默认选择，如果有多摄像头识别，界面中展示下拉框，用户可以切换选择使用哪一个摄像头；
  - 预览窗口实时显示
- 默认图像质量大小
  - 压缩率：高/中/低三档可选
- 默认视频拍摄时长
  - 默认时长：60秒
  - 可调范围：10-300秒

## 3.6 本地化功能（生产环境部署）
### 3.6.1 配置管理
- 首次启动配置向导
- 配置文件存储位置
- 配置项目说明

### 3.6.2 数据管理
- SQLite 数据库位置
- 数据库初始化脚本
新克隆项目后运行：
1 初始化数据库记录数据：
cd /node-backend
npm run init-db

2 初始化数据库设置数据：
cd /node-backend
生产环境部署
export NODE_ENV=production
运行初始化脚本
node scripts/init-db-settings.js

如果是从  csv 更新到 sqlite 需要做数据迁移
生产环境下：执行迁移命令
npm run migrate:prod
开发环境下：执行迁移命令
npm run migrate


- 数据备份与恢复
在设置界面数据库模块，点击”备份数据库“即可将数据库备份下载到本地保存

- 数据清理规则

### 3.6.3 系统集成
- 开机自启动设置
- 系统托盘功能
- 快捷键支持

### 3.6.4 更新机制
- 版本检查
- 自动更新
- 更新日志

## 4. 非功能需求
### 4.1 性能需求
- 响应时间：
- 并发处理：
- 存储容量：

### 4.2 安全需求
- 数据安全：
- 访问控制：
- 审计日志：

### 4.3 可用性需求
- 系统可用性：
- 错误处理：
- 用户体验：

## 5. 界面设计
### 5.1 页面布局
[可以附上关键页面的线框图或设计稿]

### 5.2 交互流程
[描述主要功能的交互流程]

## 6. 技术架构
### 6.1 系统架构
- 前端架构：
- 后端架构：
- 存储方案：

### 6.2 接口设计
[列出主要API接口定义]

## 7. 数据结构
[描述主要数据结构和关系]

## 8. 部署方案
- 环境要求
- 部署步骤
- 数据库升级方案
<!-- # 从 CSV 导入数据到SQLite -->
NODE_ENV=production node scripts/migrate-from-csv.js
<!-- # 执行SQLite数据库结构迁移 -->
NODE_ENV=production node scripts/migrate-db.js

可以通过终端启动应用来查看输出：
/Applications/小茉莉相机.app/Contents/MacOS/小茉莉相机

- 监控方案

## 9. 测试计划
- 测试范围
- 测试用例
- 验收标准

## 10. 项目里程碑
[列出项目主要时间节点和交付物]

## 11. 风险评估
[列出可能的风险和应对方案]


## 用户数据库
MySQL 数据库
需求：存储用户数据，包括用户名、密码、邮箱等信息。
字段：id, username, password, email, created_at, updated_at
索引：username, email
约束：username, email 唯一 